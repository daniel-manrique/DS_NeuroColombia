{
  "hash": "4328a890e3e97a5ed10c3e5a9c81737e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Cleaning and Processing\"\n---\n\n\n\n\n## Install and Load Packages\n\nWe begin by installing and loading the necessary R packages for data manipulation and processing. These packages provide the tools required for reading Excel files, manipulating strings, and performing efficient data frame operations.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!requireNamespace(\"dplyr\", quietly = TRUE)) install.packages(\"dplyr\")\nif (!requireNamespace(\"gt\", quietly = TRUE)) install.packages(\"gt\")\nif (!requireNamespace(\"purrr\", quietly = TRUE)) install.packages(\"purrr\")\nif (!requireNamespace(\"readxl\", quietly = TRUE)) install.packages(\"readxl\")\nif (!requireNamespace(\"stringr\", quietly = TRUE)) install.packages(\"stringr\")\nif (!requireNamespace(\"stringi\", quietly = TRUE)) install.packages(\"stringi\")\nif (!requireNamespace(\"tidyr\", quietly = TRUE)) install.packages(\"tidyr\")\n\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(gt)\nlibrary(purrr)\nlibrary(readxl)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readxl' was built under R version 4.4.2\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(stringr)\nlibrary(stringi)\nlibrary(tidyr)\n```\n:::\n\n\n\n\n## Handling of Neurodevelopmental Data\n\nThis section details the processing of raw neurodevelopmental consultation data obtained from the Colombian Ministry of Health. Our objective is to transform the raw Excel sheets into a structured, standardized dataset suitable for analysis.\n\n### Load Data\n\nThe raw data is stored in a single Excel file (`Ministry_OriginalData.xlsx`) containing multiple sheets. We use `readxl::excel_sheets()` to retrieve all sheet names and then apply `purrr::map_dfr()` to iteratively read each sheet and combine them into a single data frame, `Ministry_data_Raw`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the file path \nfile_path <- \"Data_Raw/Ministry_OriginalData.xlsx\"\n\n# Get all sheet names\nsheet_names <- excel_sheets(file_path)\n\n# Read all sheets and combine them\nMinistry_data_Raw <- map_dfr(sheet_names, ~ read_excel(file_path, sheet = .x), .id = \"SheetName\")\n```\n:::\n\n\n\n\nWe display the first 10 rows to inspect the raw structure of the dataset.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngt::gt(Ministry_data_Raw[1:10,])\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ppinlrejiz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ppinlrejiz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ppinlrejiz thead, #ppinlrejiz tbody, #ppinlrejiz tfoot, #ppinlrejiz tr, #ppinlrejiz td, #ppinlrejiz th {\n  border-style: none;\n}\n\n#ppinlrejiz p {\n  margin: 0;\n  padding: 0;\n}\n\n#ppinlrejiz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ppinlrejiz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ppinlrejiz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ppinlrejiz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ppinlrejiz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ppinlrejiz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ppinlrejiz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ppinlrejiz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ppinlrejiz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ppinlrejiz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ppinlrejiz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ppinlrejiz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ppinlrejiz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ppinlrejiz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ppinlrejiz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppinlrejiz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ppinlrejiz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ppinlrejiz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ppinlrejiz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppinlrejiz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ppinlrejiz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppinlrejiz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ppinlrejiz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppinlrejiz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ppinlrejiz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ppinlrejiz .gt_left {\n  text-align: left;\n}\n\n#ppinlrejiz .gt_center {\n  text-align: center;\n}\n\n#ppinlrejiz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ppinlrejiz .gt_font_normal {\n  font-weight: normal;\n}\n\n#ppinlrejiz .gt_font_bold {\n  font-weight: bold;\n}\n\n#ppinlrejiz .gt_font_italic {\n  font-style: italic;\n}\n\n#ppinlrejiz .gt_super {\n  font-size: 65%;\n}\n\n#ppinlrejiz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ppinlrejiz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ppinlrejiz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ppinlrejiz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ppinlrejiz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ppinlrejiz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ppinlrejiz .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ppinlrejiz .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ppinlrejiz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SheetName\">SheetName</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Año\">Año</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Departamento\">Departamento</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Municipio\">Municipio</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Diagnósticos\">Diagnósticos</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Edad\">Edad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sexo\">Sexo</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Personas-Atendidas\">Personas Atendidas</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 02 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">MASCULINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 04 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">FEMENINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 04 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">MASCULINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 06 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">FEMENINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 06 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">MASCULINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 06 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">NR - NO REPORTADO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 07 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">FEMENINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 07 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">MASCULINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 08 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">FEMENINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"SheetName\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Año\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Departamento\" class=\"gt_row gt_left\">05 - Antioquia</td>\n<td headers=\"Municipio\" class=\"gt_row gt_left\">05001 - Medellín</td>\n<td headers=\"Diagnósticos\" class=\"gt_row gt_left\">F700 - RETRASO MENTAL LEVE: DETERIORO DEL COMPORTAMIENTO NULO O MINIMO</td>\n<td headers=\"Edad\" class=\"gt_row gt_left\">De 08 años</td>\n<td headers=\"Sexo\" class=\"gt_row gt_left\">MASCULINO</td>\n<td headers=\"Personas Atendidas\" class=\"gt_row gt_right\">6</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n### Clean and Standardize Ministry Data\n\nUpon visual inspection, we identify several inconsistencies that require cleaning. We perform the following steps to standardize the data.\n\n#### Rename Columns\n\nFirst, we rename the columns from Spanish to English to ensure clarity and consistency throughout the analysis. We also remove the `SheetName` column as it is no longer needed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Eliminate the first column\nMinistry_data_Raw <- Ministry_data_Raw %>% select(-SheetName)\n\n# Change column names in order\ncolnames(Ministry_data_Raw) <- c(\"Year\", \"Department\",  \"City\", \"Diagnostic\", \"Age\", \"Sex\", \"Cases\")\n```\n:::\n\n\n\n\n#### Clean Data Values\n\nNext, we clean the values within the columns using string manipulation and recoding techniques:\n\n-   **Department/City**: We remove numerical prefixes (e.g., \"05 - Antioquia\") and convert the text to Title Case.\n-   **Diagnostic**: We extract only the ICD-10 code (e.g., \"F900\"), discarding the descriptive text.\n-   **Age**: We extract only the numeric age value.\n-   **Sex**: We recode the values from Spanish (\"MASCULINO\", \"FEMENINO\") to English (\"Men\", \"Women\").\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMinistry_data_clean <- Ministry_data_Raw %>%\n  # Remove numbers and hyphen from 'Department' column\n  mutate(Department = str_remove(Department, \"^\\\\d+\\\\s-\\\\s*\"),\n         Department = str_to_title(Department)) %>%  # Convert to Title Case\n  \n  # Remove numbers and hyphen from 'City' column\n  mutate(City = str_remove(City, \"^\\\\d+\\\\s-\\\\s*\"),\n         City = str_to_title(City)) %>%  # Convert to Title Case\n  \n  # Extract only the diagnostic code starting with \"F\"\n  mutate(Diagnostic = str_extract(Diagnostic, \"^F\\\\d+\")) %>%\n  \n  # Extract only numeric values from 'Age' column\n  mutate(Age = str_extract(Age, \"\\\\d+\")) %>%\n  \n  # Replace \"MASCULINO\" with \"Men\" and \"FEMENINO\" with \"Women\"\n  mutate(Sex = recode(Sex, \"MASCULINO\" = \"Men\", \"FEMENINO\" = \"Women\"))\n```\n:::\n\n\n\n\n#### Standardize Text (Unicode and Capitalization)\n\nTo ensure accurate joins with other datasets (such as population data), we must standardize all text fields.\n\n-   **Accents**: We use `stringi::stri_trans_general()` to remove all Spanish accents (e.g., \"Bogotá\" becomes \"Bogota\").\n-   **Capitalization**: We standardize common articles (e.g., \"De\", \"Del\") to lowercase (\"de\", \"del\") and ensure \"D.C.\" is correctly formatted for Bogotá.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove accents\nMinistry_data_clean <- Ministry_data_clean %>%\n  mutate(\n    Department = stri_trans_general(Department, \"Latin-ASCII\"),\n    City = stri_trans_general(City, \"Latin-ASCII\")\n  )\n\n# Fix capitalization and \"D.C.\"\nMinistry_data_clean <- Ministry_data_clean %>%\n  mutate(City = str_replace_all(City, \"\\\\bDe\\\\b\", \"de\"),\n         City = str_replace_all(City, \"\\\\bDel\\\\b\", \"del\"),\n         City = str_replace_all(City, \"\\\\bLa\\\\b\", \"la\"),\n         Department = str_replace_all(Department, \"\\\\bDe\\\\b\", \"de\"),\n         Department = str_replace_all(Department, \"\\\\bDel\\\\b\", \"del\"),\n         Department = str_replace(Department, \"\\\\bD.c\\\\b\", \"D.C\"),\n         City = str_replace(City, \"\\\\bD.c\\\\b\", \"D.C\"),\n         City = str_replace(City, \"Bogota\", \"Bogota, D.C\"))\n\n# Fix potential duplicates created by the replace (e.g., \"Bogota, D.C, D.C.\")\nMinistry_data_clean <- Ministry_data_clean %>%\n  mutate(\n    City = case_when(\n      City == \"Bogota, D.C, D.C.\" ~ \"Bogota, D.C.\", TRUE ~ City ))\n```\n:::\n\n\n\n\nWe verify the cleaned table structure:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngt::gt(Ministry_data_clean[1:10,])\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"jrryckziwa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jrryckziwa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jrryckziwa thead, #jrryckziwa tbody, #jrryckziwa tfoot, #jrryckziwa tr, #jrryckziwa td, #jrryckziwa th {\n  border-style: none;\n}\n\n#jrryckziwa p {\n  margin: 0;\n  padding: 0;\n}\n\n#jrryckziwa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jrryckziwa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jrryckziwa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jrryckziwa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jrryckziwa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jrryckziwa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jrryckziwa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jrryckziwa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jrryckziwa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jrryckziwa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jrryckziwa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jrryckziwa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jrryckziwa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jrryckziwa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jrryckziwa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jrryckziwa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jrryckziwa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jrryckziwa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jrryckziwa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jrryckziwa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jrryckziwa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jrryckziwa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jrryckziwa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jrryckziwa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jrryckziwa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jrryckziwa .gt_left {\n  text-align: left;\n}\n\n#jrryckziwa .gt_center {\n  text-align: center;\n}\n\n#jrryckziwa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jrryckziwa .gt_font_normal {\n  font-weight: normal;\n}\n\n#jrryckziwa .gt_font_bold {\n  font-weight: bold;\n}\n\n#jrryckziwa .gt_font_italic {\n  font-style: italic;\n}\n\n#jrryckziwa .gt_super {\n  font-size: 65%;\n}\n\n#jrryckziwa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jrryckziwa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jrryckziwa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jrryckziwa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jrryckziwa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jrryckziwa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jrryckziwa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#jrryckziwa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#jrryckziwa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Year\">Year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Department\">Department</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"City\">City</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Diagnostic\">Diagnostic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Age\">Age</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sex\">Sex</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Cases\">Cases</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">02</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Men</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">04</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Women</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">04</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Men</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Women</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Men</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">NR - NO REPORTADO</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">07</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Women</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">07</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Men</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">8</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Women</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"Year\" class=\"gt_row gt_right\">2016</td>\n<td headers=\"Department\" class=\"gt_row gt_left\">Antioquia</td>\n<td headers=\"City\" class=\"gt_row gt_left\">Medellin</td>\n<td headers=\"Diagnostic\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Age\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Sex\" class=\"gt_row gt_left\">Men</td>\n<td headers=\"Cases\" class=\"gt_row gt_right\">6</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n### Subset Ministry Data\n\nWe filter the dataset based on the study's specific inclusion criteria:\n\n-   **Sex**: We include only \"Men\" and \"Women\" (excluding \"NO REPORTADO\").\n-   **Age**: We include children aged 0 to 11 years, inclusive.\n-   **Location**: We exclude entries where Department or City is \"No Definido\" (Not defined).\n-   **Data Types**: We ensure that Year and Age columns are numeric.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMinistery_DiagnosticData <- Ministry_data_clean %>%\n  filter(Sex %in% c(\"Men\", \"Women\"),\n         as.numeric(Age) >= 0 & as.numeric(Age) <= 11,\n         !Department %in% c(\"No Definido\", \"-1 - No Definido\"),\n         !City %in% c(\"No Definido\", \"-1 - No Definido\"))\n\n# Make sure year and age are numerical\nMinistery_DiagnosticData$Year <- as.numeric(Ministery_DiagnosticData$Year)\nMinistery_DiagnosticData$Age <- as.numeric(Ministery_DiagnosticData$Age)\n```\n:::\n\n\n\n\nThe resulting table contains `382,008` diagnostic cases. We display the structure of the dataset to verify its attributes:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Display the subsetted dataset\nstr(Ministery_DiagnosticData)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [382,008 × 7] (S3: tbl_df/tbl/data.frame)\n $ Year      : num [1:382008] 2016 2016 2016 2016 2016 ...\n $ Department: chr [1:382008] \"Antioquia\" \"Antioquia\" \"Antioquia\" \"Antioquia\" ...\n $ City      : chr [1:382008] \"Medellin\" \"Medellin\" \"Medellin\" \"Medellin\" ...\n $ Diagnostic: chr [1:382008] \"F700\" \"F700\" \"F700\" \"F700\" ...\n $ Age       : num [1:382008] 2 4 4 6 6 7 7 8 8 9 ...\n $ Sex       : chr [1:382008] \"Men\" \"Women\" \"Men\" \"Women\" ...\n $ Cases     : num [1:382008] 1 2 1 1 1 3 8 5 6 8 ...\n```\n\n\n:::\n:::\n\n\n\n\nThe table contains the following variables:\n\n-   **Year**: Year in which the neurological diagnosis was made (2016–2022).\n-   **Department**: Geographical Colombian department where the diagnosis was made.\n-   **City**: City where the diagnosis was made.\n-   **Diagnosis**: Neurodevelopmental diagnosis according to [ICD-10](https://icd.who.int/en/).\n-   **Age**: Age of the diagnosed person.\n-   **Sex**: Biological sex/gender of the diagnosed person (Men or Women).\n-   **Cases**: Number of diagnosed cases.\n\nWe save this intermediate cleaned file. This table contains only the case data, without population denominators. The cleaned data is used in the subsequent analyses: [Consultation Frequency Analysis](1_Consultation_Frequency.qmd).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(Ministery_DiagnosticData, \"Data_Processed/Ministery_DiagnosticData.csv\", row.names = FALSE, fileEncoding = \"UTF-8\")\n```\n:::\n\n\n\n\n::: callout-warning\nPlease note that as this file contains special Spanish characters, if opened in Excel, the user needs to ensure the correct encoding:\n\n1.  Open Excel → Go to Data → Get External Data → From Text.\n2.  Choose the .csv file and set **UTF-8** encoding in the import wizard.\n:::\n\n## Handling of DANE Population Data\n\nIn this section, we load, clean, and reshape the population data from DANE (National Administrative Department of Statistics) to serve as the denominator for calculating consultation rates.\n\n### Load and Subset DANE Data\n\nWe load two separate Excel files containing population projections (2005-2019 and 2020-2035) and merge them using `rbind()`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDane_Data_2019 <- read_excel(\"Data_Raw/DANE_PopulationData_2005-2019.xlsx\") \nDane_Data_2035 <- read_excel(\"Data_Raw/DANE_PopulationData_2020-2035.xlsx\")\n\n# We merge the datasets\nDane_Data_Total <- rbind(Dane_Data_2019, Dane_Data_2035)\n```\n:::\n\n\n\n\nWe then subset this large dataset to match our study criteria:\n\n-   **ÁREA GEOGRÁFICA**: \"Total\" (to include both urban and rural populations).\n-   **AÑO**: 2016 to 2022.\n-   **DPNOM / DPMP**: Exclude \"No Definido\".\n-   **Columns**: We select only the ID columns (DPNOM, DPMP, AÑO) and the population columns for men and women aged 0-11 (e.g., \"Hombres_0\"...\"Mujeres_11\").\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We select the rows containing total counts\nDane_Data_Total <- subset(Dane_Data_Total, `ÁREA GEOGRÁFICA` == \"Total\")\n\n# We subset ID variables and population columns\nDane_Data_Total <- Dane_Data_Total %>%\n  filter(AÑO >= 2016 & AÑO <= 2022,\n         DPNOM != \"No Definido\",\n         DPMP != \"No Definido\") %>%\n  select(DPNOM, DPMP, AÑO, matches(\"^(Hombres|Mujeres)_([0-9]|1[0-1])$\"))\n```\n:::\n\n\n\n\nThe resulting table provides information on the number of men (Hombres) and women (Mujeres) from 0 to 11 years of age by year, department, and city in Colombia.\n\n### Standardize DANE Text\n\nAs with the Ministry data, we standardize all text (remove accents, normalize capitalization) to prepare for merging.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDane_Data_Total <- Dane_Data_Total %>%\n  mutate(\n    DPNOM = stri_trans_general(DPNOM, \"Latin-ASCII\"),\n    DPMP = stri_trans_general(DPMP, \"Latin-ASCII\")\n  )\n\nDane_Data_Total <- Dane_Data_Total %>%\n  mutate(DPMP = str_replace_all(DPMP, \"\\\\bDe\\\\b\", \"de\"),\n         DPMP = str_replace_all(DPMP, \"\\\\bDel\\\\b\", \"del\"),\n         DPMP = str_replace_all(DPMP, \"\\\\bLa\\\\b\", \"la\"),\n         DPNOM = str_replace_all(DPNOM, \"\\\\bDe\\\\b\", \"de\"),\n         DPNOM = str_replace_all(DPNOM, \"\\\\bDel\\\\b\", \"del\"))\n```\n:::\n\n\n\n\n### Reshape DANE Data (Wide to Long)\n\nThe DANE data is initially in a \"wide\" format (one column for each age-sex group). We use `tidyr::pivot_longer()` to reshape it into a \"long\" format. This creates one row per city-year-sex-age combination, with columns `Sexo`, `Edad`, and `Poblacion`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDane_Data_Total_long <- Dane_Data_Total %>%\n  pivot_longer(\n    cols = c(starts_with(\"Hombres_\"), starts_with(\"Mujeres_\")),\n    names_to = c(\"Sexo\", \"Edad\"),\n    names_sep = \"_\",\n    values_to = \"Poblacion\"\n  )\n\nDane_Data_Total_long$Edad <- as.numeric(Dane_Data_Total_long$Edad)\n```\n:::\n\n\n\n\n### Standardize DANE Columns\n\nFinally, we rename the DANE columns (DPNOM -> Department, etc.) and recode Sex (\"Hombres\" -> \"Men\") to exactly match the `Ministery_DiagnosticData` table.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Change column names in order\ncolnames(Dane_Data_Total_long) <- c(\"Department\", \"City\",  \"Year\", \"Sex\", \"Age\", \"Population\")\n\n# Replace \"Hombres\" with \"Men\" and \"Mujeres\" with \"Women\"\nDane_Data_Total_long <- Dane_Data_Total_long %>%\n  mutate(Sex = recode(Sex, \"Hombres\" = \"Men\", \"Mujeres\" = \"Women\"))\n```\n:::\n\n\n\n\n## Relate Diagnostic and Population Data\n\n### Handle Join Mismatches\n\nOur goal is to join the `Ministery_DiagnosticData` with `Dane_Data_Total_long`. However, preliminary checks revealed NAs, indicating naming convention mismatches between the two datasets (e.g., \"Cartagena de Indias\" vs. \"Cartagena\").\n\nTo resolve this, we manually recode the city/department names in the `Dane_Data_Total_long` dataset to match the names used in the `Ministery_DiagnosticData` dataset.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDane_Data_Total_long <- Dane_Data_Total_long %>%\n  mutate(\n    City = case_when(\n      City == \"Cartagena de Indias\" ~ \"Cartagena\",\n      City == \"San Jose de Cucuta\" ~ \"Cucuta\",\n      City == \"Piendamo - Tunia\" ~ \"Piendamo\",\n      City == \"Archipielago de San Andres\" ~ \"Archipielago de San Andres, Providencia Y Santa Catalina\",\n      City == \"Cuaspud Carlosama\" ~ \"Cuaspud\",\n      City == \"Donmatias\" ~ \"Don Matias\",\n      City == \"Purisima de La Concepcion\" ~ \"Purisima\",\n      City == \"Sotara Paispamba\" ~ \"Sotara\",\n      City == \"Manaure Balcon del Cesar\" ~ \"Manaure\",\n      City == \"Puerto Leguizamo\" ~ \"Leguizamo\",\n      City == \"Cacahual (ANM)\" ~ \"Cacahual\",\n      City == \"Guican de La Sierra\" ~ \"Guican\",\n      City == \"Lopez de Micay\" ~ \"Lopez\",\n      City == \"El Encanto (ANM)\" ~ \"El Encanto\",\n      City == \"La Chorrera (ANM)\" ~ \"La Chorrera\",\n      City == \"Tarapaca (ANM)\" ~ \"Tarapaca\",\n      City == \"Barrancominas (ANM)\" ~ \"Barrancominas\",\n      City == \"La Pedrera (ANM)\" ~ \"La Pedrera\",\n      City == \"Puerto Santander (ANM)\" ~ \"Puerto Santander\",\n      City == \"Puerto Colombia (ANM)\" ~ \"Puerto Colombia\",\n      TRUE ~ City ),\n   \n    Department = case_when(\n      Department == \"Archipielago de San Andres\" ~ \"Archipielago de San Andres, Providencia Y Santa Catalina\",\n      TRUE ~ Department )\n  )\n```\n:::\n\n\n\n\n### Merge Datasets\n\nWith the names corrected, we perform a `dplyr::left_join()` to add the `Population` column to our `Ministery_DiagnosticData`. The join is based on the unique key of **City**, **Department**, **Year**, **Sex**, and **Age**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMinistery_Data_with_pop <- Ministery_DiagnosticData %>%\n  left_join(Dane_Data_Total_long,\n            by = c(\"City\",  \n                   \"Department\",\n                   \"Year\",           \n                   \"Sex\",                 \n                   \"Age\"                   \n            ))\n\n# As a domain-specific step, we incorporate Bogota, D.C. into the Cundinamarca department\n# This treats Bogota as part of Cundinamarca for analysis.\nMinistery_Data_with_pop <- Ministery_Data_with_pop %>%\n  mutate(\n    Department = case_when(\n      Department == \"Bogota, D.C.\" ~ \"Cundinamarca\",\n      TRUE ~ Department )\n  )\n```\n:::\n\n\n\n\nWe check for any remaining NAs and drop them, as they represent entries that could not be paired with a population count.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMinistery_Data_with_pop <- Ministery_Data_with_pop %>%\n  drop_na()\n```\n:::\n\n\n\n\n## Feature Engineering\n\nWe now engineer new variables to facilitate our analysis.\n\n### Capital City Status\n\nWe create a binary variable `Capital` (\"Yes\" / \"No\") to indicate if a city is a department capital. This is achieved by creating a capitals lookup table and joining it to our main dataset.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a lookup table for department capitals\ncapitals <- tibble(\n  Department = c(\"Amazonas\", \"Antioquia\", \"Arauca\", \"Atlantico\", \"Bolivar\", \n                   \"Boyaca\", \"Caldas\", \"Caqueta\", \"Casanare\", \"Cauca\", \"Cesar\", \n                   \"Choco\", \"Cordoba\", \"Cundinamarca\", \"Guainia\", \"Guaviare\", \n                   \"Huila\", \"La Guajira\", \"Magdalena\", \"Meta\", \"Narino\", \n                   \"Norte de Santander\", \"Putumayo\", \"Quindio\", \"Risaralda\", \n                   \"Archipielago de San Andres, Providencia Y Santa Catalina\", \"Santander\", \"Sucre\", \"Tolima\", \n                   \"Valle del Cauca\", \"Vaupes\", \"Vichada\"),\n  CapitalCity = c(\"Leticia\", \"Medellin\", \"Arauca\", \"Barranquilla\", \"Cartagena\", \n                   \"Tunja\", \"Manizales\", \"Florencia\", \"Yopal\", \"Popayan\", \"Valledupar\", \n                   \"Quibdo\", \"Monteria\", \"Bogota, D.C.\", \"Inirida\", \"San Jose del Guaviare\", \n                   \"Neiva\", \"Riohacha\", \"Santa Marta\", \"Villavicencio\", \"Pasto\", \n                   \"Cucuta\", \"Mocoa\", \"Armenia\", \"Pereira\", \"San Andres\", \n                   \"Bucaramanga\", \"Sincelejo\", \"Ibague\", \"Cali\", \"Mitu\", \"Puerto Carreno\")\n)\n\n# Join with capitals lookup and create the \"Capital\" column\nMinistery_Data_with_capital <- Ministery_Data_with_pop %>%\n  left_join(capitals, by = \"Department\") %>%\n  mutate(Capital = if_else(City == CapitalCity, \"Yes\", \"No\"))\n```\n:::\n\n\n\n\n### Normalized Diagnostic Rates\n\nUsing the new `Population` column, we calculate three normalized rates:\n\n-   **Diagnostics_per_tenthousand**: Cases per 10,000 inhabitants (of the reference population).\n-   **Diagnostics_per_houndredthousand**: Cases per 100,000 inhabitants (of the reference population).\n-   **Diagnostics_Percentage**: The raw percentage of the population diagnosed.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMinistery_Data_Compiled <- Ministery_Data_with_capital %>%\n  mutate(Diagnostics_per_tenthousand = round((Cases / Population) * 10000))\n\nMinistery_Data_Compiled <- Ministery_Data_Compiled %>%\n  mutate(Diagnostics_per_houndredthousand = round((Cases / Population) * 100000))\n\nMinistery_Data_Compiled <- Ministery_Data_Compiled %>%\n  mutate(Diagnostics_Percentage = (Cases / Population))\n```\n:::\n\n\n\n\n### Diagnostic Groups\n\nFinally, we create a higher-level `Diagnostic_Group` column (e.g., F70, F80) using `case_when()` to bin the specific ICD-10 codes into broader categories.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMinistery_Data_Compiled <- Ministery_Data_Compiled %>%\n  mutate(Diagnostic_Group = case_when(\n    Diagnostic %in% c(\"F700\", \"F701\", \"F708\", \"F709\", \"F711\", \"F710\", \"F718\", \"F719\", \"F720\", \"F721\", \"F728\", \"F729\", \"F730\", \"F731\", \"F738\", \"F739\",\"F780\", \"F781\", \"F788\", \"F789\", \"F790\", \"F799\", \"F798\", \"F791\") ~ \"F70\",\n    Diagnostic %in% c(\"F800\", \"F801\", \"F802\", \"F803\", \"F804\", \"F805\", \"F806\", \"F807\", \"F808\", \"F809\") ~ \"F80\",\n    Diagnostic %in% c(\"F810\", \"F811\", \"F812\", \"F813\", \"F818\", \"F8181\", \"F8189\", \"F819\") ~ \"F81\",\n    Diagnostic == \"F82\" ~ \"F82\",\n    Diagnostic == \"F83\" ~ \"F83\",\n    Diagnostic %in% c(\"F840\", \"F841\", \"F842\", \"F843\", \"F844\", \"F845\", \"F846\", \"F847\", \"F848\", \"F849\") ~ \"F84\",\n    Diagnostic == \"F88\" ~ \"F88\",\n    Diagnostic == \"F89\" ~ \"F89\",\n    Diagnostic %in% c(\"F900\", \"F901\", \"F908\", \"F909\") ~ \"F90\",\n    TRUE ~ NA_character_\n  ))\n```\n:::\n\n\n\n\n## Final Export\n\nWe save the fully cleaned, merged, and feature-engineered dataset. This file, `Ministery_DiagnosticData_Compiled.csv`, serves as the master dataset for all subsequent analysis chapters.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(Ministery_Data_Compiled, \"Data_Processed/Ministery_DiagnosticData_Compiled.csv\", row.names = FALSE)\n```\n:::\n",
    "supporting": [
      "0_NeuroColombia_DataCleaning_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}