{
  "hash": "8417783f2e88003400c00c41edab3916",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Diagnostic Frequency Analysis\"\n---\n\n\n\n\n## Load Project Setup\n\nThis chunk sources the `_common.R` script, which loads all packages, the `Plot_theme`, and the main `Neuro_Data` data frame.\n\n\n\n\n\n\n\n\n\n## Consultations per Diagnostic\n\nWe begin by examining how often each diagnostic category appears in the consultation records. This provides a broad overview of the distribution of neurodevelopmental conditions in the dataset and helps us identify which diagnoses account for the largest share of consultations.\n\n### Data Preparation\n\nWe group the full dataset by diagnostic category and compute the total number of consultations associated with each condition. This step collapses the dataset across departments and years, allowing us to quantify the overall importance of each diagnostic group at the national level.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSummary_Diagnostic <- Neuro_Data %>%\n  group_by(Diagnostic) %>%\n  summarise(Total_Cases = sum(Cases, na.rm = TRUE)) %>%\n  ungroup()\n\nSummary_Diagnostic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 51 × 2\n   Diagnostic Total_Cases\n   <chr>            <int>\n 1 F700             24236\n 2 F701             11144\n 3 F708              7298\n 4 F709              7252\n 5 F710             12251\n 6 F711             10112\n 7 F718              4458\n 8 F719              5700\n 9 F720              2327\n10 F721              5306\n# ℹ 41 more rows\n```\n\n\n:::\n:::\n\n\n\n\n### Data Visualization: Top 10 Diagnostics\n\nThe full dataset contains dozens of diagnostic categories, and plotting all of them at once would obscure meaningful patterns. To focus on the most prevalent conditions, we extract the 10 diagnostic categories with the highest number of consultations using `slice_max()`. The bar chart in @fig-Diagnostics_Top10 displays these top diagnoses, ordered from the most to the least frequent. We annotate each bar with the exact number of consultations and use a color gradient to highlight the relative magnitude of each category.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for the 10 most frequent cases\ntop_10_data <- Summary_Diagnostic %>%\n  slice_max(Total_Cases, n = 10)\n\n# Create the bar plot\nDiagnostic_fig_Top10 <- ggplot(top_10_data, \n                               aes(y = reorder(Diagnostic, Total_Cases), # Re-ordered smallest to largest for this plot\n                                   x = Total_Cases,\n                                   fill = Total_Cases)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_distiller(palette = \"Blues\", direction = 1) +\n  geom_text(aes(label=Total_Cases), vjust=0.5, hjust = -0.1, color=\"black\", size=4) +\n  labs(x = \"Total cases\", y = \"ICD-10 nerodevelopmental diagnostics\", \n       title = \"10 most frequent consultations\") +\n  Plot_theme + \n  theme(axis.text.x=element_blank(),\n        axis.ticks.x=element_blank(),\n        legend.position = \"none\") +\n  scale_x_continuous(expand = expansion(mult = c(0, 0.15)))\n\n# Save the new figure\nggsave(Diagnostic_fig_Top10,\n       filename = \"Plots/Diagnostic_fig_Top10.png\",\n       width    = 16, \n       height   = 15,\n       units    = \"cm\")\n\nDiagnostic_fig_Top10\n```\n\n::: {.cell-output-display}\n![Distribution of the 10 most frequent neurodevelopmental diagnostics (CIE-11).](2_Consultation_DiagnosticFrecuency_files/figure-html/fig-Diagnostics_Top10-1.png){#fig-Diagnostics_Top10 width=576}\n:::\n:::\n\n\n\n\nThe distribution of consultations is heavily concentrated in a small number of diagnostic categories. The hyperactive disorder diagnosis (F900) is by far the most common, with more than 300,000 consultations. Other highly frequent diagnoses include mixed developmental disorders (F809) and speech and language disorders (F808), each surpassing 200,000 consultations. Even the least frequent categories in the top 10 exceed 80,000 consultations, indicating that a limited set of neurodevelopmental conditions dominate the national consultation load.\n\n### Full Diagnostic Table\n\nTo provide a complete overview of the diagnostic spectrum, we construct a table that lists all ICD-10 neurodevelopmental diagnostic categories and their total number of consultations. Because the full list is long, we sort the diagnostics from most to least frequent and then distribute them into three column groups. We format the resulting wide table with `gt`, add column group headings, and apply a simple APA-style layout. The table is exported both as LaTeX (for direct inclusion in the manuscript) and as a Word document, so that readers and collaborators can easily reuse or adapt the information.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# --- 1. Sort the data ---\nsorted_data <- Summary_Diagnostic %>%\n  arrange(desc(Total_Cases))\n\n# --- 2. Prepare data for 3 columns ---\nn_rows <- nrow(sorted_data)\nrows_per_col <- ceiling(n_rows / 3)\nna_row <- tibble(Diagnostic = NA_character_, Total_Cases = NA_integer_)\n\ncol1 <- sorted_data %>% slice(1:rows_per_col)\ncol2 <- sorted_data %>% slice((rows_per_col + 1):min(2 * rows_per_col, n_rows))\ncol3 <- sorted_data %>% slice((2 * rows_per_col + 1):n_rows)\n\n# Pad shorter columns with NA rows\nif (nrow(col2) < rows_per_col) {\n  col2 <- bind_rows(col2, slice(na_row, rep(1, rows_per_col - nrow(col2))))\n}\nif (nrow(col3) < rows_per_col) {\n  col3 <- bind_rows(col3, slice(na_row, rep(1, rows_per_col - nrow(col3))))\n}\n\n# --- 4. Combine into one wide dataframe ---\nmulti_col_data <- bind_cols(\n  col1 %>% rename(Diagnostic_1 = Diagnostic, Cases_1 = Total_Cases),\n  col2 %>% rename(Diagnostic_2 = Diagnostic, Cases_2 = Total_Cases),\n  col3 %>% rename(Diagnostic_3 = Diagnostic, Cases_3 = Total_Cases)\n)\n```\n:::\n\n\n\n\n#### Results Table\n\nThe prepared `multi_col_data` is formatted with `gt`. We use `tab_spanner` to create \"Group 1\", \"Group 2\", and \"Group 3\" headers over the columns.\n\n\n\n\n::: {#tbl-Diagnostics .cell tbl-cap='Full list of consultations per diagnostic category'}\n\n```{.r .cell-code}\npublication_table_gt <- multi_col_data %>%\n  gt() %>%\n  tab_header(\n    title    = md(\"**Table 2. Consultations by ICD-10 neurodevelopmental diagnostic category**\"),\n    subtitle = \"Sorted from most to least frequent and arranged in three column groups.\"\n  ) %>%\n  # Column groupings\n  tab_spanner(label = \"Group 1\", columns = c(Diagnostic_1, Cases_1)) %>%\n  tab_spanner(label = \"Group 2\", columns = c(Diagnostic_2, Cases_2)) %>%\n  tab_spanner(label = \"Group 3\", columns = c(Diagnostic_3, Cases_3)) %>%\n  # Column labels under the spanners\n  cols_label(\n    Diagnostic_1 = \"Diagnostic\", Cases_1 = \"Cases\",\n    Diagnostic_2 = \"Diagnostic\", Cases_2 = \"Cases\",\n    Diagnostic_3 = \"Diagnostic\", Cases_3 = \"Cases\"\n  ) %>%\n  # Number formatting\n  fmt_number(\n    columns  = c(Cases_1, Cases_2, Cases_3),\n    use_seps = TRUE,\n    decimals = 0\n  ) %>%\n  # Show padded NAs as blank cells\n  fmt_missing(\n    columns      = everything(),\n    missing_text = \"\"\n  ) %>%\n  theme_apa_gt() %>%\n  tab_source_note(\n    source_note = \"Note. ICD-10 neurodevelopmental diagnostics, ordered by total number of consultations.\"\n  )\n\npublication_table_gt\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pnyiaunnxk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pnyiaunnxk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pnyiaunnxk thead, #pnyiaunnxk tbody, #pnyiaunnxk tfoot, #pnyiaunnxk tr, #pnyiaunnxk td, #pnyiaunnxk th {\n  border-style: none;\n}\n\n#pnyiaunnxk p {\n  margin: 0;\n  padding: 0;\n}\n\n#pnyiaunnxk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #000000;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pnyiaunnxk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pnyiaunnxk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pnyiaunnxk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pnyiaunnxk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pnyiaunnxk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pnyiaunnxk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pnyiaunnxk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #000000;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pnyiaunnxk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pnyiaunnxk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: none;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pnyiaunnxk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: none;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pnyiaunnxk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pnyiaunnxk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pnyiaunnxk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pnyiaunnxk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnyiaunnxk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pnyiaunnxk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pnyiaunnxk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pnyiaunnxk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnyiaunnxk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pnyiaunnxk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnyiaunnxk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pnyiaunnxk .gt_table_body {\n  border-top-style: none;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnyiaunnxk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pnyiaunnxk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pnyiaunnxk .gt_left {\n  text-align: left;\n}\n\n#pnyiaunnxk .gt_center {\n  text-align: center;\n}\n\n#pnyiaunnxk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pnyiaunnxk .gt_font_normal {\n  font-weight: normal;\n}\n\n#pnyiaunnxk .gt_font_bold {\n  font-weight: bold;\n}\n\n#pnyiaunnxk .gt_font_italic {\n  font-style: italic;\n}\n\n#pnyiaunnxk .gt_super {\n  font-size: 65%;\n}\n\n#pnyiaunnxk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pnyiaunnxk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pnyiaunnxk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pnyiaunnxk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pnyiaunnxk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pnyiaunnxk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pnyiaunnxk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#pnyiaunnxk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#pnyiaunnxk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"6\" class=\"gt_heading gt_title gt_font_normal\" style><span data-qmd-base64=\"PHN0cm9uZz5UYWJsZSAyLiBDb25zdWx0YXRpb25zIGJ5IElDRC0xMCBuZXVyb2RldmVsb3BtZW50YWwgZGlhZ25vc3RpYyBjYXRlZ29yeTwvc3Ryb25nPg==\"><span class='gt_from_md'><strong>Table 2. Consultations by ICD-10 neurodevelopmental diagnostic category</strong></span></span></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"6\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Sorted from most to least frequent and arranged in three column groups.</td>\n    </tr>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Group 1\">\n        <div class=\"gt_column_spanner\">Group 1</div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Group 2\">\n        <div class=\"gt_column_spanner\">Group 2</div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Group 3\">\n        <div class=\"gt_column_spanner\">Group 3</div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Diagnostic_1\">Diagnostic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Cases_1\">Cases</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Diagnostic_2\">Diagnostic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Cases_2\">Cases</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Diagnostic_3\">Diagnostic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Cases_3\">Cases</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F900</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">301,353</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F711</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">10,112</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F908</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">2,300</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F809</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">228,881</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F799</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">9,159</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F729</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">2,142</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F808</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">213,846</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F845</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">8,193</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F83</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">1,877</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F801</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">116,571</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F708</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">7,298</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F728</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">1,739</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F819</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">110,695</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F709</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">7,252</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F844</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">1,713</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F800</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">107,053</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F802</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">6,760</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F788</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">1,360</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F813</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">87,979</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F89</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">6,333</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F780</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">1,014</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F840</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">87,219</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F719</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">5,700</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F781</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">1,013</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F818</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">86,717</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F909</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">5,640</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F843</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">871</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F848</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">27,732</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F721</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">5,306</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F842</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">850</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F849</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">25,547</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F810</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">5,299</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F731</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">645</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F700</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">24,236</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F718</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">4,458</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F812</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">561</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F82</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">24,195</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F798</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">4,161</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F803</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">538</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F901</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">21,699</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F790</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">3,929</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F811</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">501</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F841</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">12,797</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F791</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">3,356</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F730</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">420</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F710</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">12,251</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F789</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">2,643</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F738</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">410</td></tr>\n    <tr><td headers=\"Diagnostic_1\" class=\"gt_row gt_left\">F701</td>\n<td headers=\"Cases_1\" class=\"gt_row gt_right\">11,144</td>\n<td headers=\"Diagnostic_2\" class=\"gt_row gt_left\">F720</td>\n<td headers=\"Cases_2\" class=\"gt_row gt_right\">2,327</td>\n<td headers=\"Diagnostic_3\" class=\"gt_row gt_left\">F739</td>\n<td headers=\"Cases_3\" class=\"gt_row gt_right\">388</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"6\">Note. ICD-10 neurodevelopmental diagnostics, ordered by total number of consultations.</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n#### Save the Table\n\nWe export the table to HTML and LaTeX.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngtsave(publication_table_gt,\n       filename = \"Tables/Diagnostic_table.html\")\n\ngtsave(publication_table_gt,\n       filename = \"Tables/Diagnostic_table.tex\")\n```\n:::\n\n\n\n\nAnd we also create a Word version.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(flextable)\nlibrary(officer)\n\n# Build a flextable with grouped headers for Word export\npublication_table_ft <- flextable(multi_col_data)\n\npublication_table_ft <- publication_table_ft %>%\n  # First header row: group labels\n  add_header_row(\n    values    = c(\"Group 1\", \"Group 2\", \"Group 3\"),\n    colwidths = c(2, 2, 2)\n  ) %>%\n  # Second header row: column labels\n  set_header_labels(\n    Diagnostic_1 = \"Diagnostic\", Cases_1 = \"Cases\",\n    Diagnostic_2 = \"Diagnostic\", Cases_2 = \"Cases\",\n    Diagnostic_3 = \"Diagnostic\", Cases_3 = \"Cases\"\n  ) %>%\n  theme_apa_flextable() %>%\n  # Center group headers and column labels; bold them\n  align(part = \"header\", align = \"center\") %>%\n  bold(part = \"header\", bold = TRUE) %>%\n  # Right-align numeric columns in the body\n  align(\n    j     = c(\"Cases_1\", \"Cases_2\", \"Cases_3\"),\n    align = \"right\",\n    part  = \"body\"\n  ) %>%\n  # Add a table note at the bottom\n  add_footer_lines(\n    values = \"Note. ICD-10 neurodevelopmental diagnostics, ordered by total number of consultations.\"\n  ) %>%\n  align(part = \"footer\", align = \"left\")\n\n# Export to Word\nsave_as_docx(\n  \"Table 1. Consultations by ICD-10 neurodevelopmental diagnostic category\" = publication_table_ft,\n  path = \"Tables/Diagnostic_table.docx\"\n)\n```\n:::\n\n\n\n\n## Create Data Subset for Downstream Analysis\n\nBased on the table and plot, we see that \"F900\", \"F809\", and \"F808\" are the most frequent diagnostics. For the next part of the analysis (see [Deep Dive: Top 3 Diagnostics](3_Consultation_MostFrequent.qmd)), we will focus only on these three.\n\nThis chunk filters the original `Neuro_Data` to keep only these diagnostics and saves the result as a new CSV file. This new file will be the input for the next notebook.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNeuro_Data_MainDiag <- Neuro_Data  %>%\n  filter(Diagnostic %in% c(\"F900\", \"F809\", \"F808\"))\n\nwrite.csv(Neuro_Data_MainDiag, \"Data_Processed/Neuro_Data_MainDiag.csv\", row.names = FALSE)\n```\n:::\n",
    "supporting": [
      "2_Consultation_DiagnosticFrecuency_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}